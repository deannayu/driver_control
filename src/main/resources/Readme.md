# Test Procedures for OOI Drivers

```
    yo fuck you yo yo
```

DriverControl provides an interface for testing of OOI instrument protocol drivers. 

# Setup

## Configuration File

Prior to testing you must setup a configuration file containing the following yaml values:

**driver_host** Location the driver is running (or should be launched). Typically, *localhost*.

**egg_url** Location of the driver distribution package (egg). This can be a file or URL.

**command_port_file** Location of the file containing the command port. This file is generated by the driver
launch script. If using Driver Control to launch the driver, set to */tmp/command_port*. 

**event_port_file** Location of the file containing the event port. This file is generated by the driver 
launch script. If using Driver Control to launch the driver, set to */tmp/event_port*.

**database_file** Location of the preload database. This database is generated from the Preload Spreadsheet using 
Pete's Perfect Parse Preload program. Parse Preload can be downloaded from [http://github.com/petercable/parse_preload]
(http://github.com/petercable/parse_preload). 
Follow the instructions to generate the database and provide the filename for this argument. 

``` 
    git clone <url from github>
    ./parse_preload
``` 

You may need to install the following programs:

```
    pip install openpyxl docopt
```

**scenario** The scenario is the name of the driver as specified in the preload sheet. This

The configuration file can be provided as an argument to Driver Control using the argument 
'--config-file=<config_file_path>'.

**port_agent_config** The following parameters must be specified for the port agent:

* **addr** Port agent address. Should be set to *rsn-port-agent-test.oceanobservatories.org*.
* **port** Port agent port. This is driver dependent. This is specified on the 
[RSN agent supervisor webpage](http://rsn-port-agent-test.oceanobservatories.org:9001).
* **cmd_port** Port agent command port. Similar to the agent port. Should be 1000 less than the agent port. 

**startup_config** The following parameters must be specified for the startup configuration:

* **parameters** A full set of startup parameters can be provided for the driver to load on startup.

The following driver configuration file sets up testing for the TRHPH instrument driver:

```
    driver_config:
      driver_host: localhost
      egg_url: /Users/danmergens/Workspace/eggs/trhph/uw_bars_ooicore-0.0.4-py2.7.egg
      command_port_file: /tmp/command_port
      event_port_file: /tmp/event_port
      database_file: /tmp/preload.db
      scenario: THSPH_A
    port_agent_config:
      addr: rsn-port-agent-test.oceanobservatories.org
      port: 13008
      cmd_port: 12008
    startup_config:
      parameters:
```

## 




